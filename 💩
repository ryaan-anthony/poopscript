#!/bin/bash

# Interpret the instructions
function interpret
{
  instructions=$*
  # Comments are skipped
  if [[ $instructions == "ğŸ‘ƒ"* ]]; then continue
  # Log mixed data to file
  elif [[ $instructions == "ğŸš½"* ]]; then eval "echo ${instructions/ğŸš½}" >> "ğŸš½.log"
  # Evaluate statements
  elif [[ $instructions == "ğŸ’©"* ]]; then eval "${instructions/ğŸ’©}"
  # Output text to stdout
  elif [[ $instructions ]]; then eval "echo $instructions"
  fi
}

# Read from user input
function interactive_mode
{
  while true; do
    echo -n "ğŸš» "
    read line
    interpret $line
  done
}

# Read from file
function batch_mode
{
  while read -r line; do
    interpret $line
  done < "$1"
}

case "$1" in
  -i|--interactive)
    interactive_mode
    exit 0
    ;;
  *)
    batch_mode $*
    exit 0
    ;;
esac
